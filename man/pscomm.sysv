.TH PSCOMM 8 "14 July 1987" "Adobe Systems"
\" Copyright (c) 1985,1987 Adobe Systems Incorporated. All Rights Reserved.
\" ATTN GOVERNMENT END USERS: See notice of rights in file XPSLIBDIRX/Notice
\" RCSID: $Header: pscomm.sysv,v 2.2 87/11/17 16:47:34 byron Rel $
.ds PS P\s-2OST\s+2S\s-2CRIPT\s+2
.ds TS T\s-2RAN\s+2S\s-2CRIPT\s+2
.SH NAME
pscomm, psrv, pstext, psbanner, psinterface \- T\s-2RAN\s+2S\s-2CRIPT\s+2 spooler filters for P\s-2OST\s+2S\s-2CRIPT\s+2 printers
.SH "SYNOPSIS"
.B XPSLIBDIRX/ps*
.SH "DESCRIPTION"
These are the low-level \*(TS interface filters for use by the 
System V line printer spooling system.
The
.I psinterface
shell script is the printer interface program as supplied to 
.I lpadmin.
The options are as specified in the
.I Line Printer Spooling Utilities Guide.
This shell script reads a printer-specific shell script named 
transcript/\fIprinter\fP.opt
below the current working directory (the lp spooling directory) which
may do additional printer-specific processing.
The \fIprinter\fP.opt script is often used to redefine the values of
some environment variables which regulate page-reversal,
how to print banner pages, etc. for specific printers.  See below.
.PP
.I psinterface
is responsible for the complete processing of the print job.
If job banner break pages are enabled for this printer (and requested
for this job),
.I psinterface
will invoke
.I psbanner
to format a banner break page.
.I psinterface
also distinguishes between text files (which get formatted) and \*(PS print 
files.  If the input to 
.I psinterface
does not begin with the \*(PS 
.B magic number
\- the first two characters being ``%!'' \-
.I psinterface
will invoke
.I pstext
to create a listing of the file.
If the first bytes of the input file are ``%!PS-Adobe-'',
and if the printer options so specify,
.I psinterface
will also page-reverse the file (with the
.I psrv
filter) before printing.
.PP
.I psinterface
currently recognizes three \*(TS-specific spooling options (presented to 
.I lp
with the
.B \-o
flag): the 
.B h
option suppresses the printing of a banner break page, the
.B r
option suppresses page reversal, and the 
.B m
option causes 
.I psinterface
to send any stream output from the execution of the user's \*(PS
print file back to the user as mail.
.PP
The program 
.I pscomm
is the lowest level filter.  It manages communication with the printer,
error handling, status reporting, etc.  
.I psinterface 
and 
.I pscomm
manage a printer log file named
transcript/\fIprinter\fP-log (under the lp spooling directory).
This file contains a log of each job processed, as well as any
error output from the printer.  In particular, it contains messages
regarding out-of-paper, paper-jams, etc.  Doing a 
.I tail
on this file will help determine the printer's status.
.PP
.B "psinterface environment variables."
.br
There are a number of environment variables used by the spooler filters.
These are listed below.
The
.I psinterface
script sets the initial value for each,
and the \fIprinter\fP.opt file can be used to change the value for a
particular printer.
Note that Bourne shell syntax must be used in both
.I psinterface,
and the \fIprinter\fP.opt file.
Many of the variables take a number value, and specify whether
an action should take place or not; 1 means do the action, and
0 means don't do it.
.PP
.ta 2.75i
.tc .
REVERSE=\fInumber\fP	Reverse the page order
.br
BANNERFIRST=\fInumber\fP	Print banner at start of job
.br
BANNERLAST=\fInumber\fP	Print banner at end of job
.br
BANNERPRO=\fIfile name\fP	Banner prolog file
.br
VERBOSELOG=\fInumber\fP	Print verbose log messages
.br
PSTEMPDIR=\fIDirectory name\fP	Directory for temp files
.PP
One could turn off page reversal for a particular printer
by adding this line to the \fIprinter\fP.opt file:
.br
\ \ \ \ REVERSE=0
.br
Or change the banner page for a particular printer by redefining
the BANNERPRO value.
.SH FILES
.TP
XPSLIBDIRX/
\*(PS library, prologues, filters, etc.
.TP
\fIspooldir\fP/transcript/\fIprinter\fP-log
Printer log file.
.TP
\fIspooldir\fP/transcript/\fIprinter\fP.opt
Printer-specific options script.
.TP
XPSTEMPDIRX/b*
Banner break page temporary file generated by 
.IR psinterface/psbanner .
.TP
XPSTEMPDIRX/o*
Job output temporary file for mail.
.TP
XPSTEMPDIRX/t*
Temporary file to format text files.
.SH "SEE ALSO"
transcript(1), lp(1), lpstat(1), lpsched(1M), lpadmin(1M).
.br
.I System V Line Printer Spooling Utilities
.SH AUTHOR
Adobe Systems Incorporated
.SH NOTES
\*(PS is a registered trademark of Adobe Systems Incorporated.
.br
\*(TS is a trademark of Adobe Systems Incorporated.
