.TH PSCOMM 8 "14 July 1987" "Adobe Systems"
\" Copyright (c) 1985,1987 Adobe Systems Incorporated. All Rights Reserved.
\" ATTN GOVERNMENT END USERS: See notice of rights in file XPSLIBDIRX/Notice
\" RCSID: $Header: pscomm.bsd,v 2.2 87/11/17 16:47:28 byron Rel $
.ds PS P\s-2OST\s+2S\s-2CRIPT\s+2
.ds TS T\s-2RAN\s+2S\s-2CRIPT\s+2
.SH NAME
pscomm, ps?f, psbad, psrv, pstext, psbanner, psint \- T\s-2RAN\s+2S\s-2CRIPT\s+2 spooler filters for P\s-2OST\s+2S\s-2CRIPT\s+2 printers
.SH "SYNOPSIS"
.B XPSLIBDIRX/ps*
.SH "DESCRIPTION"
These are the low-level \*(TS interface filters for use by the 
4.2BSD line printer spooling system through the printer description file 
.IR /etc/printcap .  
The 
.I ps?f
entries are all links to the 
.I psint.sh
shell script.  This script uses argv[0] (the name it was invoked under)
to determine which action to take.
The options are as specified in the
.I 4.2BSD Line Printer Spooler Manual.  
This shell script reads a printer-specific shell script named 
.I .options
in the current working directory (the spooling directory) which
may do additional printer-specific processing.
The \fI.options\fP script is often used to redefine the values of some
environment variables which regulate page-reversal, how to print
banner pages, etc.  See below.
.PP
The 
.I psof
entry is responsible for formatting a banner break page.  It exec's
the 
.I psbanner
filter which leaves the banner page in a file named ``.banner''
for 
.I pscomm 
to print.
The program 
.I pscomm
is the lowest level filter.  It manages communication with the printer,
error handling, status reporting, etc.
It distinguishes between text files and \*(PS print 
files.  If the input to 
.I pscomm
does not begin with the \*(PS 
.B magic number
\-\- the first two characters being ``%!'' \-\-
.I pscomm
will invoke
.I pstext
to format the file in the \*(PS language, then list it to the printer.
If the first bytes of the input file are ``%!PS-Adobe-'',
and if the printer options so specify,
.I pscomm
will also page-reverse the file (with the
.I psrv
filter) before printing.
.PP
All other ``formatting'' filters run
.I pscomm
at the far end of a pipeline, the nearer end doing translation to \*(PS only.
.I psgf, psnf,
and
.I pstf,
are the filters for
.IR plot (5), 
.IR ditroff (1), 
and
.IR  troff (1)
respectively.  
The 
.I psif
filter will also accept any \*(PS print file, such as those 
generated by Scribe.
Other filter entries, such as those for 
.I TeX DVI 
files,
.I cifplot,
and raw raster data are not available in the \*(TS package,
although they may be available from other sources.
The default action for these filter types is to execute 
.I psbad,
a script which prints and logs an error message that the
translation filter is not available.
The translation filters are usually invoked by giving an option to
.IR lpr (1).
It is not correct to invoke the interface filters
directly.
More flexibility in format conversion may be achieved by
invoking the appropriate translator directly, rather than specifying an
.I lpr
option.
.PP
.B "psint.sh environment variables."
.br
There are a number of environment variables used by the spooler filters.
These are listed below.
The
.I psint.sh
script sets the initial value for each,
and the \fI.options\fP file can be used to change the value for a
particular printer.
Note that Bourne shell syntax must be used in both
.I psint.sh
and the \fI.options\fP file.
Many of the variables take a number value, and specify whether
an action should take place or not; 1 means do the action, and
0 means don't do it.
.PP
.ta 2.75i
.tc .
REVERSE=\fIProgram name\fP	Program to reverse page order
.br
BANNERFIRST=\fInumber\fP	Print banner at start of job
.br
BANNERLAST=\fInumber\fP	Print banner at end of job
.tc
.br
(See note below)	0=No banner at end
.br
	1=Don't unlink .banner file
.br
	2=Unlink .banner after use
.br
.tc .
BANNERPRO=\fIfile name\fP	Banner prolog file
.br
VERBOSELOG=\fInumber\fP	Print verbose log messages
.br
PSTEXT=\fIProgram name\fP	Converts text to \*(PS
.PP
.I Note:
Due to some problems with the design of \fIlpd(8)\fP, there is no
implementation of BANNERLAST that will work in all cases.
Two options are provided:
.br
1) BANNERLAST=1.
This prints out a banner between each copy in a multiple-copy job.
It also may print out \fIthe previous user's\fP banner on a job that has
specified no banner
(\fIlpr\fP \-h).
.br
2) BANNERLAST=2.
This never prints a banner on a job that has specified no banner
(\fIlpr\fP \-h).
However, it prints a banner after \fIthe first copy\fP only in a
multiple-copy job.
It should be after all copies or after the final copy.
.PP
One could turn off page reversal for a particular printer
by adding this line to the \fI.options\fP file:
.br
\ \ \ \ REVERSE=
.br
Or change the banner page for a particular printer by redefining
the BANNERPRO value.
.SH FILES
.TP
XPSLIBDIRX/
\*(PS library, prologues, filters, etc.
.TP
XPSTEMPDIRX/RV*
Temporary files for 
.I psrv.
.IP ".options"
Printer-specific options script (in the printer spool directory).
.TP
\fIprinter\fP.acct
Printer accounting file.
.TP
\fIprinter\fP-log
Printer log file.
.IP ".banner"
Banner break page temporary file (in the spool directory) , generated by 
.IR psof/psbanner .
.TP
status
Printer status file (in the spool directory), shared by 
.IR lpd (8),
and
.IR pscomm .
.SH "SEE ALSO"
transcript(1), lpr(1), lpc(8), lpd(8), printcap(5).
.br
.I 4.2BSD Line Printer Spooler Manual
.SH AUTHOR
Adobe Systems Incorporated
.SH NOTES
\*(PS is a registered trademark of Adobe Systems Incorporated.
.br
\*(TS is a trademark of Adobe Systems Incorporated.
.br
Scribe and Unilogic are registered trademarks of Unilogic, Ltd.
.br
TeX is a trademark of the American Mathematical Society.
